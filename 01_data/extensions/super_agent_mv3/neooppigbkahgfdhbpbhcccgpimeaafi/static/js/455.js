/*! For license information please see 455.js.LICENSE.txt */
(self.webpackChunkextension=self.webpackChunkextension||[]).push([[455],{1266:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=(0,r(5878).Z)("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"])},8518:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(2791),i=r(4578),o=r(2007),s=r.n(o),a=1073741823,c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:{};const u=n.createContext||function(e,t){var r,o,u="__create-react-context-"+function(){var e="__global_unique_id__";return c[e]=(c[e]||0)+1}()+"__",l=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).emitter=function(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(r,n){e=r,t.forEach((function(t){return t(e,n)}))}}}(t.props.value),t}(0,i.Z)(r,e);var n=r.prototype;return n.getChildContext=function(){var e;return(e={})[u]=this.emitter,e},n.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var r,n=this.props.value,i=e.value;((o=n)===(s=i)?0!==o||1/o===1/s:o!==o&&s!==s)?r=0:(r="function"===typeof t?t(n,i):a,0!==(r|=0)&&this.emitter.set(e.value,r))}var o,s},n.render=function(){return this.props.children},r}(n.Component);l.childContextTypes=((r={})[u]=s().object.isRequired,r);var d=function(t){function r(){var e;return(e=t.apply(this,arguments)||this).state={value:e.getValue()},e.onUpdate=function(t,r){0!==((0|e.observedBits)&r)&&e.setState({value:e.getValue()})},e}(0,i.Z)(r,t);var n=r.prototype;return n.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=void 0===t||null===t?a:t},n.componentDidMount=function(){this.context[u]&&this.context[u].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?a:e},n.componentWillUnmount=function(){this.context[u]&&this.context[u].off(this.onUpdate)},n.getValue=function(){return this.context[u]?this.context[u].get():e},n.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},r}(n.Component);return d.contextTypes=((o={})[u]=s().object,o),{Provider:l,Consumer:d}}},888:(e,t,r)=>{"use strict";var n=r(9047);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,s){if(s!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},2007:(e,t,r)=>{e.exports=r(888)()},9047:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},1372:(e,t)=>{"use strict";var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,a=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,u=r?Symbol.for("react.context"):60110,l=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,p=r?Symbol.for("react.forward_ref"):60112,h=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,E=r?Symbol.for("react.lazy"):60116,m=r?Symbol.for("react.block"):60121,_=r?Symbol.for("react.fundamental"):60117,I=r?Symbol.for("react.responder"):60118,y=r?Symbol.for("react.scope"):60119;function v(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case l:case d:case o:case a:case s:case h:return e;default:switch(e=e&&e.$$typeof){case u:case p:case E:case g:case c:return e;default:return t}}case i:return t}}}function b(e){return v(e)===d}t.AsyncMode=l,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=c,t.Element=n,t.ForwardRef=p,t.Fragment=o,t.Lazy=E,t.Memo=g,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=h,t.isAsyncMode=function(e){return b(e)||v(e)===l},t.isConcurrentMode=b,t.isContextConsumer=function(e){return v(e)===u},t.isContextProvider=function(e){return v(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return v(e)===p},t.isFragment=function(e){return v(e)===o},t.isLazy=function(e){return v(e)===E},t.isMemo=function(e){return v(e)===g},t.isPortal=function(e){return v(e)===i},t.isProfiler=function(e){return v(e)===a},t.isStrictMode=function(e){return v(e)===s},t.isSuspense=function(e){return v(e)===h},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===d||e===a||e===s||e===h||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===E||e.$$typeof===g||e.$$typeof===c||e.$$typeof===u||e.$$typeof===p||e.$$typeof===_||e.$$typeof===I||e.$$typeof===y||e.$$typeof===m)},t.typeOf=v},7441:(e,t,r)=>{"use strict";e.exports=r(1372)},3381:e=>{e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},3813:(e,t,r)=>{var n=r(3381);e.exports=h,e.exports.parse=o,e.exports.compile=function(e,t){return a(o(e,t),t)},e.exports.tokensToFunction=a,e.exports.tokensToRegExp=p;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e,t){for(var r,n=[],o=0,s=0,a="",l=t&&t.delimiter||"/";null!=(r=i.exec(e));){var d=r[0],p=r[1],h=r.index;if(a+=e.slice(s,h),s=h+d.length,p)a+=p[1];else{var f=e[s],g=r[2],E=r[3],m=r[4],_=r[5],I=r[6],y=r[7];a&&(n.push(a),a="");var v=null!=g&&null!=f&&f!==g,b="+"===I||"*"===I,P="?"===I||"*"===I,T=r[2]||l,S=m||_;n.push({name:E||o++,prefix:g||"",delimiter:T,optional:P,repeat:b,partial:v,asterisk:!!y,pattern:S?u(S):y?".*":"[^"+c(T)+"]+?"})}}return s<e.length&&(a+=e.substr(s)),a&&n.push(a),n}function s(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function a(e,t){for(var r=new Array(e.length),i=0;i<e.length;i++)"object"===typeof e[i]&&(r[i]=new RegExp("^(?:"+e[i].pattern+")$",d(t)));return function(t,i){for(var o="",a=t||{},c=(i||{}).pretty?s:encodeURIComponent,u=0;u<e.length;u++){var l=e[u];if("string"!==typeof l){var d,p=a[l.name];if(null==p){if(l.optional){l.partial&&(o+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(n(p)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var h=0;h<p.length;h++){if(d=c(p[h]),!r[u].test(d))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(d)+"`");o+=(0===h?l.prefix:l.delimiter)+d}}else{if(d=l.asterisk?encodeURI(p).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):c(p),!r[u].test(d))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+d+'"');o+=l.prefix+d}}else o+=l}return o}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function l(e,t){return e.keys=t,e}function d(e){return e&&e.sensitive?"":"i"}function p(e,t,r){n(t)||(r=t||r,t=[]);for(var i=(r=r||{}).strict,o=!1!==r.end,s="",a=0;a<e.length;a++){var u=e[a];if("string"===typeof u)s+=c(u);else{var p=c(u.prefix),h="(?:"+u.pattern+")";t.push(u),u.repeat&&(h+="(?:"+p+h+")*"),s+=h=u.optional?u.partial?p+"("+h+")?":"(?:"+p+"("+h+"))?":p+"("+h+")"}}var f=c(r.delimiter||"/"),g=s.slice(-f.length)===f;return i||(s=(g?s.slice(0,-f.length):s)+"(?:"+f+"(?=$))?"),s+=o?"$":i&&g?"":"(?="+f+"|$)",l(new RegExp("^"+s,d(r)),t)}function h(e,t,r){return n(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?function(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return l(e,t)}(e,t):n(e)?function(e,t,r){for(var n=[],i=0;i<e.length;i++)n.push(h(e[i],t,r).source);return l(new RegExp("(?:"+n.join("|")+")",d(r)),t)}(e,t,r):function(e,t,r){return p(o(e,r),t,r)}(e,t,r)}},6645:(e,t,r)=>{"use strict";function n(e){return"/"===e.charAt(0)}function i(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}r.d(t,{Z:()=>o});const o=function(e,t){void 0===t&&(t="");var r,o=e&&e.split("/")||[],s=t&&t.split("/")||[],a=e&&n(e),c=t&&n(t),u=a||c;if(e&&n(e)?s=o:o.length&&(s.pop(),s=s.concat(o)),!s.length)return"/";if(s.length){var l=s[s.length-1];r="."===l||".."===l||""===l}else r=!1;for(var d=0,p=s.length;p>=0;p--){var h=s[p];"."===h?i(s,p):".."===h?(i(s,p),d++):d&&(i(s,p),d--)}if(!u)for(;d--;d)s.unshift("..");!u||""===s[0]||s[0]&&n(s[0])||s.unshift("");var f=s.join("/");return r&&"/"!==f.substr(-1)&&(f+="/"),f}},6111:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n="Invariant failed";const i=function(e,t){if(!e)throw new Error(n)}},4881:(e,t,r)=>{"use strict";var n=r(1413),i=Object.defineProperty,o=(e,t,r)=>((e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),s=(e=>(e[e.Silent=0]="Silent",e[e.Error=1]="Error",e[e.Warn=2]="Warn",e[e.Info=3]="Info",e[e.Debug=4]="Debug",e[e.Verbose=5]="Verbose",e))(s||{});class a{static setLogLevel(e){this.logLevel=e}static log(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.logLevel;const r="[Purchases] ".concat(e);if(!(this.logLevel<t||t===s.Silent))switch(t){case s.Error:console.error(r);break;case s.Warn:console.warn(r);break;case s.Info:console.info(r);break;case s.Debug:case s.Verbose:console.debug(r)}}static errorLog(e){this.log(e,s.Error)}static warnLog(e){this.log(e,s.Warn)}static infoLog(e){this.log(e,s.Info)}static debugLog(e){this.log(e,s.Debug)}static verboseLog(e){this.log(e,s.Verbose)}}o(a,"logLevel",s.Silent);var c=(e=>(e[e.ErrorSettingUpPurchase=0]="ErrorSettingUpPurchase",e[e.ErrorChargingPayment=1]="ErrorChargingPayment",e[e.UnknownError=2]="UnknownError",e[e.NetworkError=3]="NetworkError",e[e.MissingEmailError=4]="MissingEmailError",e[e.AlreadyPurchasedError=5]="AlreadyPurchasedError",e[e.StripeTaxNotActive=6]="StripeTaxNotActive",e[e.StripeInvalidTaxOriginAddress=7]="StripeInvalidTaxOriginAddress",e[e.StripeMissingRequiredPermission=8]="StripeMissingRequiredPermission",e))(c||{}),u=(e=>(e[e.UnknownError=0]="UnknownError",e[e.UserCancelledError=1]="UserCancelledError",e[e.StoreProblemError=2]="StoreProblemError",e[e.PurchaseNotAllowedError=3]="PurchaseNotAllowedError",e[e.PurchaseInvalidError=4]="PurchaseInvalidError",e[e.ProductNotAvailableForPurchaseError=5]="ProductNotAvailableForPurchaseError",e[e.ProductAlreadyPurchasedError=6]="ProductAlreadyPurchasedError",e[e.ReceiptAlreadyInUseError=7]="ReceiptAlreadyInUseError",e[e.InvalidReceiptError=8]="InvalidReceiptError",e[e.MissingReceiptFileError=9]="MissingReceiptFileError",e[e.NetworkError=10]="NetworkError",e[e.InvalidCredentialsError=11]="InvalidCredentialsError",e[e.UnexpectedBackendResponseError=12]="UnexpectedBackendResponseError",e[e.InvalidAppUserIdError=14]="InvalidAppUserIdError",e[e.OperationAlreadyInProgressError=15]="OperationAlreadyInProgressError",e[e.UnknownBackendError=16]="UnknownBackendError",e[e.InvalidAppleSubscriptionKeyError=17]="InvalidAppleSubscriptionKeyError",e[e.IneligibleError=18]="IneligibleError",e[e.InsufficientPermissionsError=19]="InsufficientPermissionsError",e[e.PaymentPendingError=20]="PaymentPendingError",e[e.InvalidSubscriberAttributesError=21]="InvalidSubscriberAttributesError",e[e.LogOutWithAnonymousUserError=22]="LogOutWithAnonymousUserError",e[e.ConfigurationError=23]="ConfigurationError",e[e.UnsupportedError=24]="UnsupportedError",e[e.EmptySubscriberAttributesError=25]="EmptySubscriberAttributesError",e[e.CustomerInfoError=28]="CustomerInfoError",e[e.SignatureVerificationError=36]="SignatureVerificationError",e[e.InvalidEmailError=38]="InvalidEmailError",e))(u||{});class l{static getPublicMessage(e){switch(e){case 0:return"Unknown error.";case 1:return"Purchase was cancelled.";case 2:return"There was a problem with the store.";case 3:return"The device or user is not allowed to make the purchase.";case 4:return"One or more of the arguments provided are invalid.";case 5:return"The product is not available for purchase.";case 6:return"This product is already active for the user.";case 7:return"There is already another active subscriber using the same receipt.";case 8:return"The receipt is not valid.";case 9:return"The receipt is missing.";case 10:return"Error performing request. Please check your network connection and try again.";case 11:return"There was a credentials issue. Check the underlying error for more details.";case 12:return"Received unexpected response from the backend.";case 14:return"The app user id is not valid.";case 15:return"The operation is already in progress.";case 16:return"There was an unknown backend error.";case 17:return"Apple Subscription Key is invalid or not present. In order to provide subscription offers, you must first generate a subscription key. Please see https://docs.revenuecat.com/docs/ios-subscription-offers for more info.";case 18:return"The User is ineligible for that action.";case 19:return"App does not have sufficient permissions to make purchases.";case 20:return"The payment is pending.";case 21:return"One or more of the attributes sent could not be saved.";case 22:return"Called logOut but the current user is anonymous.";case 23:return"There is an issue with your configuration. Check the underlying error for more details.";case 24:return"There was a problem with the operation. Looks like we doesn't support that yet. Check the underlying error for more details.";case 25:return"A request for subscriber attributes returned none.";case 28:return"There was a problem related to the customer info.";case 36:return"Request failed signature verification. Please see https://rev.cat/trusted-entitlements for more info.";case 38:return"Email is not valid. Please provide a valid email address."}}static getErrorCodeForBackendErrorCode(e){switch(e){case 7101:case 7773:case 7898:case 7899:case 7900:case 7901:case 7229:case 7231:return 2;case 7102:return 7;case 7103:return 8;case 7107:case 7224:case 7225:return 11;case 7105:case 7106:case 7814:case 7877:case 7878:return 4;case 7772:return 6;case 7220:return 14;case 7259:return 28;case 7230:case 7e3:return 23;case 7232:return 18;case 7263:case 7264:return 21;case 7104:case 7234:case 7226:case 7110:return 12;case 7662:return 24;case 7012:case 7834:case 7879:return 38}}static convertCodeToBackendErrorCode(e){return e in d?e:null}static convertPurchaseFlowErrorCodeToErrorCode(e){switch(e){case c.ErrorSettingUpPurchase:return 2;case c.ErrorChargingPayment:return 20;case c.NetworkError:return 10;case c.MissingEmailError:return 4;case c.AlreadyPurchasedError:return 6;default:return 0}}}var d=(e=>(e[e.BackendInvalidPlatform=7e3]="BackendInvalidPlatform",e[e.BackendInvalidEmail=7012]="BackendInvalidEmail",e[e.BackendStoreProblem=7101]="BackendStoreProblem",e[e.BackendCannotTransferPurchase=7102]="BackendCannotTransferPurchase",e[e.BackendInvalidReceiptToken=7103]="BackendInvalidReceiptToken",e[e.BackendInvalidAppStoreSharedSecret=7104]="BackendInvalidAppStoreSharedSecret",e[e.BackendInvalidPaymentModeOrIntroPriceNotProvided=7105]="BackendInvalidPaymentModeOrIntroPriceNotProvided",e[e.BackendProductIdForGoogleReceiptNotProvided=7106]="BackendProductIdForGoogleReceiptNotProvided",e[e.BackendInvalidPlayStoreCredentials=7107]="BackendInvalidPlayStoreCredentials",e[e.BackendInternalServerError=7110]="BackendInternalServerError",e[e.BackendEmptyAppUserId=7220]="BackendEmptyAppUserId",e[e.BackendInvalidAuthToken=7224]="BackendInvalidAuthToken",e[e.BackendInvalidAPIKey=7225]="BackendInvalidAPIKey",e[e.BackendBadRequest=7226]="BackendBadRequest",e[e.BackendPlayStoreQuotaExceeded=7229]="BackendPlayStoreQuotaExceeded",e[e.BackendPlayStoreInvalidPackageName=7230]="BackendPlayStoreInvalidPackageName",e[e.BackendPlayStoreGenericError=7231]="BackendPlayStoreGenericError",e[e.BackendUserIneligibleForPromoOffer=7232]="BackendUserIneligibleForPromoOffer",e[e.BackendInvalidAppleSubscriptionKey=7234]="BackendInvalidAppleSubscriptionKey",e[e.BackendSubscriberNotFound=7259]="BackendSubscriberNotFound",e[e.BackendInvalidSubscriberAttributes=7263]="BackendInvalidSubscriberAttributes",e[e.BackendInvalidSubscriberAttributesBody=7264]="BackendInvalidSubscriberAttributesBody",e[e.BackendProductIDsMalformed=7662]="BackendProductIDsMalformed",e[e.BackendAlreadySubscribedError=7772]="BackendAlreadySubscribedError",e[e.BackendPaymentGatewayGenericError=7773]="BackendPaymentGatewayGenericError",e[e.BackendOfferNotFound=7814]="BackendOfferNotFound",e[e.BackendNoMXRecordsFound=7834]="BackendNoMXRecordsFound",e[e.BackendInvalidOperationSession=7877]="BackendInvalidOperationSession",e[e.BackendPurchaseCannotBeCompleted=7878]="BackendPurchaseCannotBeCompleted",e[e.BackendEmailIsRequired=7879]="BackendEmailIsRequired",e[e.BackendGatewaySetupErrorStripeTaxNotActive=7898]="BackendGatewaySetupErrorStripeTaxNotActive",e[e.BackendGatewaySetupErrorInvalidTaxOriginAddress=7899]="BackendGatewaySetupErrorInvalidTaxOriginAddress",e[e.BackendGatewaySetupErrorMissingRequiredPermission=7900]="BackendGatewaySetupErrorMissingRequiredPermission",e[e.BackendGatewaySetupErrorSandboxModeOnly=7901]="BackendGatewaySetupErrorSandboxModeOnly",e))(d||{});class p extends Error{constructor(e,t,r,n){super(t),o(this,"toString",(()=>"PurchasesError(code: ".concat(u[this.errorCode],", message: ").concat(this.message,")"))),this.errorCode=e,this.underlyingErrorMessage=r,this.extra=n}static getForBackendError(e,t){const r=l.getErrorCodeForBackendErrorCode(e);return new p(r,l.getPublicMessage(r),t,{backendErrorCode:e})}static getForPurchasesFlowError(e){return new p(l.convertPurchaseFlowErrorCodeToErrorCode(e.errorCode),e.message,e.underlyingErrorMessage)}}class h extends Error{constructor(){super("Purchases must be configured before calling getInstance")}}function f(e){return null==e||new Date(e)>new Date}function g(e,t,r,n){const i=t.product_identifier;if(i in r)return function(e,t,r){var n,i,o,s,a;return{identifier:e,isActive:f(t.expires_date),willRenew:I(t.expires_date,r),store:null!==(n=null==r?void 0:r.store)&&void 0!==n?n:"unknown",latestPurchaseDate:new Date(t.purchase_date),originalPurchaseDate:new Date(t.purchase_date),expirationDate:m(t.expires_date),productIdentifier:t.product_identifier,productPlanIdentifier:null!==(i=t.product_plan_identifier)&&void 0!==i?i:null,unsubscribeDetectedAt:m(null==r?void 0:r.unsubscribe_detected_at),billingIssueDetectedAt:m(null==r?void 0:r.billing_issues_detected_at),isSandbox:null!==(o=null==r?void 0:r.is_sandbox)&&void 0!==o&&o,periodType:null!==(s=null==r?void 0:r.period_type)&&void 0!==s?s:"normal",ownershipType:null!==(a=null==r?void 0:r.ownership_type)&&void 0!==a?a:"UNKNOWN"}}(e,t,r[i]);if(i in n)return function(e,t,r){return{identifier:e,isActive:!0,willRenew:!1,store:r.store,latestPurchaseDate:new Date(t.purchase_date),originalPurchaseDate:new Date(r.original_purchase_date),expirationDate:null,productIdentifier:t.product_identifier,productPlanIdentifier:null,unsubscribeDetectedAt:null,billingIssueDetectedAt:null,isSandbox:r.is_sandbox,periodType:"normal",ownershipType:"UNKNOWN"}}(e,t,n[i]);throw new p(u.CustomerInfoError,"Could not find entitlement product in subscriptions or non-subscriptions.")}function E(e,t,r){const n={},i={};for(const o in e){const s=g(o,e[o],t,r);n[o]=s,s.isActive&&(i[o]=s)}return{all:n,active:i}}function m(e){return null==e?null:new Date(e)}function _(e){const t=function(e){const t={};for(const r in e.subscriber.subscriptions){const n=e.subscriber.subscriptions[r];null==n.expires_date?t[r]=null:t[r]=new Date(n.expires_date)}return t}(e),r=e.subscriber,n=function(e){const t={};for(const r in e){if(0===e[r].length)continue;const n=e[r].length;t[r]=e[r][n-1]}return t}(r.non_subscriptions),i=Object.entries(e.subscriber.non_subscriptions).flatMap((e=>{let[t,r]=e;return r.map((e=>({transactionIdentifier:e.id,productIdentifier:t,purchaseDate:new Date(e.purchase_date||e.original_purchase_date),storeTransactionId:e.store_transaction_id||null,store:e.store})))})),o=new Date(e.request_date),s=Object.fromEntries(Object.entries(e.subscriber.subscriptions).map((e=>{var t;let[r,n]=e;return[r,{productIdentifier:r,purchaseDate:new Date(n.purchase_date),originalPurchaseDate:m(n.original_purchase_date),expiresDate:m(n.expires_date),store:n.store,unsubscribeDetectedAt:m(n.unsubscribe_detected_at),isSandbox:n.is_sandbox,billingIssuesDetectedAt:m(n.billing_issues_detected_at),gracePeriodExpiresDate:m(n.grace_period_expires_date),ownershipType:null!==(t=n.ownership_type)&&void 0!==t?t:"UNKNOWN",periodType:n.period_type,refundedAt:m(n.refunded_at),storeTransactionId:n.store_transaction_id||null,isActive:f(n.expires_date),willRenew:I(n.expires_date,n)}]})));return{entitlements:E(r.entitlements,r.subscriptions,n),allExpirationDatesByProduct:t,allPurchaseDatesByProduct:y(e,n),activeSubscriptions:v(t),managementURL:r.management_url,requestDate:o,firstSeenDate:new Date(r.first_seen),originalPurchaseDate:m(r.original_purchase_date),originalAppUserId:e.subscriber.original_app_user_id,nonSubscriptionTransactions:i,subscriptionsByProductIdentifier:s}}function I(e,t){if(null==t)return!1;const r="promotional"==t.store,n=null==e,i=null!=t.unsubscribe_detected_at,o=null!=t.billing_issues_detected_at;return!(r||n||i||o)}function y(e,t){const r={};for(const n in e.subscriber.subscriptions){const t=e.subscriber.subscriptions[n];r[n]=new Date(t.purchase_date)}for(const n in t){const e=t[n].purchase_date;r[n]=null==e?null:new Date(e)}return r}function v(e){const t=new Set,r=new Date;for(const n in e){const i=e[n];(null==i||i>r)&&t.add(n)}return t}const b="1.12.1";var P,T;(T=P||(P={}))[T.CONTINUE=100]="CONTINUE",T[T.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",T[T.PROCESSING=102]="PROCESSING",T[T.EARLY_HINTS=103]="EARLY_HINTS",T[T.OK=200]="OK",T[T.CREATED=201]="CREATED",T[T.ACCEPTED=202]="ACCEPTED",T[T.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",T[T.NO_CONTENT=204]="NO_CONTENT",T[T.RESET_CONTENT=205]="RESET_CONTENT",T[T.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",T[T.MULTI_STATUS=207]="MULTI_STATUS",T[T.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",T[T.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",T[T.MOVED_TEMPORARILY=302]="MOVED_TEMPORARILY",T[T.SEE_OTHER=303]="SEE_OTHER",T[T.NOT_MODIFIED=304]="NOT_MODIFIED",T[T.USE_PROXY=305]="USE_PROXY",T[T.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",T[T.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",T[T.BAD_REQUEST=400]="BAD_REQUEST",T[T.UNAUTHORIZED=401]="UNAUTHORIZED",T[T.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",T[T.FORBIDDEN=403]="FORBIDDEN",T[T.NOT_FOUND=404]="NOT_FOUND",T[T.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",T[T.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",T[T.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",T[T.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",T[T.CONFLICT=409]="CONFLICT",T[T.GONE=410]="GONE",T[T.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",T[T.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",T[T.REQUEST_TOO_LONG=413]="REQUEST_TOO_LONG",T[T.REQUEST_URI_TOO_LONG=414]="REQUEST_URI_TOO_LONG",T[T.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",T[T.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",T[T.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",T[T.IM_A_TEAPOT=418]="IM_A_TEAPOT",T[T.INSUFFICIENT_SPACE_ON_RESOURCE=419]="INSUFFICIENT_SPACE_ON_RESOURCE",T[T.METHOD_FAILURE=420]="METHOD_FAILURE",T[T.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",T[T.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",T[T.LOCKED=423]="LOCKED",T[T.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",T[T.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",T[T.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",T[T.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",T[T.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",T[T.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",T[T.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",T[T.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",T[T.BAD_GATEWAY=502]="BAD_GATEWAY",T[T.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",T[T.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",T[T.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",T[T.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",T[T.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED";const S=/^rcb_[a-zA-Z0-9_.-]+$/,w=/^pdl_[a-zA-Z0-9_.-]+$/,k=/^test_[a-zA-Z0-9_.-]+$/;function A(e){return!!e&&e.startsWith("rcb_sb_")}function C(e){return!!e&&k.test(e)}async function O(e,t,r){var n;const{apiKey:i,body:o,headers:s,httpConfig:a}=t,c="".concat(null!==(n=null==a?void 0:a.proxyURL)&&void 0!==n?n:"https://api.revenuecat.com").concat(e.urlPath());try{const t=await fetch(c,{method:e.method,headers:Y(i,s,null==a?void 0:a.additionalHeaders),body:U(o),signal:r});return await async function(e,t){const r=e.status;if(r>=P.INTERNAL_SERVER_ERROR)R(t,r,await e.text());else if(r>=P.BAD_REQUEST){const n=await e.json(),i=n?JSON.stringify(n):null,o=null==n?void 0:n.code,s=null==n?void 0:n.message;if(null!=o){const e=l.convertCodeToBackendErrorCode(o);if(null!=e)throw p.getForBackendError(e,s);R(t,r,i,o)}else R(t,r,i)}}(t,e),await t.json()}catch(d){throw d instanceof TypeError?new p(u.NetworkError,l.getPublicMessage(u.NetworkError),d.message):d}}function R(e,t,r,n){throw new p(u.UnknownBackendError,"Unknown backend error.","Request: ".concat(e.name,". Status code: ").concat(t,". Body: ").concat(r,"."),{backendErrorCode:n})}function U(e){return null==e?null:JSON.stringify(e)}const N="Authorization",D="Content-Type",x="Accept",B="X-Platform",L="X-Version",M="X-Platform-Flavor",F="X-Platform-Flavor-Version",K="X-Is-Sandbox",$=new Set([N,D,x,B,L,K,M,F]);function Y(e,t,r){let i={[N]:"Bearer ".concat(e),[D]:"application/json",[x]:"application/json",[B]:"web",[L]:b,[K]:"".concat(A(e))};const o=$e.getPlatformInfo();if(o){const e={[M]:o.flavor,[F]:o.version};i=(0,n.Z)((0,n.Z)({},i),e)}return t&&(i=(0,n.Z)((0,n.Z)({},i),t)),r&&(i=(0,n.Z)((0,n.Z)({},r),i)),i}const j="/v1/subscribers",G="/rcbilling/v1";class W{constructor(e){o(this,"appUserId"),o(this,"method","GET"),o(this,"name","getOfferings"),this.appUserId=e}urlPath(){const e=encodeURIComponent(this.appUserId);return"".concat(j,"/").concat(e,"/offerings")}}class V{constructor(e,t,r){o(this,"method","GET"),o(this,"name","getProducts"),o(this,"appUserId"),o(this,"productIds"),o(this,"currency"),this.appUserId=e,this.productIds=t,this.currency=r}urlPath(){const e=encodeURIComponent(this.appUserId),t=this.productIds.map(encodeURIComponent).join("&id="),r=this.currency?"&currency=".concat(this.currency):"";return"".concat(G,"/subscribers/").concat(e,"/products?id=").concat(t).concat(r)}}class Z{constructor(e){o(this,"method","GET"),o(this,"name","getCustomerInfo"),o(this,"appUserId"),this.appUserId=e}urlPath(){const e=encodeURIComponent(this.appUserId);return"".concat(j,"/").concat(e)}}class Q{constructor(){o(this,"method","GET"),o(this,"name","getBrandingInfo")}urlPath(){return"".concat(G,"/branding")}}class H{constructor(){o(this,"method","POST"),o(this,"name","postCheckoutStart")}urlPath(){return"".concat(G,"/checkout/start")}}class q{constructor(e){o(this,"method","POST"),o(this,"name","postCheckoutCalculateTax"),o(this,"operationSessionId"),this.operationSessionId=e}urlPath(){return"".concat(G,"/checkout/").concat(this.operationSessionId,"/calculate_taxes")}}class z{constructor(e){o(this,"method","POST"),o(this,"name","postCheckoutComplete"),o(this,"operationSessionId"),this.operationSessionId=e}urlPath(){return"".concat(G,"/checkout/").concat(this.operationSessionId,"/complete")}}class X{constructor(e){o(this,"method","GET"),o(this,"name","getCheckoutStatus"),o(this,"operationSessionId"),this.operationSessionId=e}urlPath(){return"".concat(G,"/checkout/").concat(this.operationSessionId)}}class J{constructor(e){o(this,"method","POST"),o(this,"name","setAttributes"),o(this,"appUserId"),this.appUserId=e}urlPath(){const e=encodeURIComponent(this.appUserId);return"".concat(j,"/").concat(e,"/attributes")}}class ee{constructor(){o(this,"method","POST"),o(this,"name","postReceipt")}urlPath(){return"/v1/receipts"}}class te{constructor(e){o(this,"method","GET"),o(this,"name","getVirtualCurrencies"),o(this,"appUserId"),this.appUserId=e}urlPath(){const e=encodeURIComponent(this.appUserId);return"".concat(j,"/").concat(e,"/virtual_currencies")}}const re={};class ne{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re;o(this,"API_KEY"),o(this,"httpConfig"),o(this,"isSandbox"),this.API_KEY=e,this.httpConfig=t,this.isSandbox=A(e)}getIsSandbox(){return this.isSandbox}async getOfferings(e){return await O(new W(e),{apiKey:this.API_KEY,httpConfig:this.httpConfig})}async getCustomerInfo(e){return await O(new Z(e),{apiKey:this.API_KEY,httpConfig:this.httpConfig})}async getProducts(e,t,r){return await O(new V(e,t,r),{apiKey:this.API_KEY,httpConfig:this.httpConfig})}async getBrandingInfo(){return await O(new Q,{apiKey:this.API_KEY,httpConfig:this.httpConfig})}async postCheckoutStart(e,t,r,n,i,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;const a={app_user_id:e,product_id:t,email:o,price_id:n.priceId,presented_offering_identifier:r.offeringIdentifier,trace_id:i};return s&&(a.metadata=s),"base_option"!==n.id&&(a.offer_id=n.id),r.targetingContext&&(a.applied_targeting_rule={rule_id:r.targetingContext.ruleId,revision:r.targetingContext.revision}),r.placementIdentifier&&(a.presented_placement_identifier=r.placementIdentifier),await O(new H,{apiKey:this.API_KEY,body:a,httpConfig:this.httpConfig})}async postCheckoutCalculateTax(e,t,r,n){const i={country_code:t,postal_code:r};return await O(new q(e),{apiKey:this.API_KEY,body:i,httpConfig:this.httpConfig},n)}async postCheckoutComplete(e,t){const r={email:t};return await O(new z(e),{apiKey:this.API_KEY,body:r,httpConfig:this.httpConfig})}async getCheckoutStatus(e){return await O(new X(e),{apiKey:this.API_KEY,httpConfig:this.httpConfig})}async setAttributes(e,t){const r=Date.now(),n={};for(const[o,s]of Object.entries(t))n[o]={value:s,updated_at_ms:r};const i={attributes:n};return await O(new J(e),{apiKey:this.API_KEY,body:i,httpConfig:this.httpConfig})}async postReceipt(e,t,r,n,i){let o=null;n.targetingContext&&(o={rule_id:n.targetingContext.ruleId,revision:n.targetingContext.revision});const s={fetch_token:r,product_id:t,app_user_id:e,presented_offering_identifier:n.offeringIdentifier,presented_placement_identifier:n.placementIdentifier,applied_targeting_rule:o,initiation_source:i};return await O(new ee,{apiKey:this.API_KEY,body:s,httpConfig:this.httpConfig})}async getVirtualCurrencies(e){return await O(new te(e),{apiKey:this.API_KEY,httpConfig:this.httpConfig})}}function ie(e,t){if(!(function(e){return!!e&&S.test(e)}(e)||C(e)||function(e){return!!e&&w.test(e)}(e)&&(null==t?void 0:t.allowPaddleAPIKey)))throw new p(u.InvalidCredentialsError,"Invalid API key. Use your Web Billing API key.")}function oe(e){if(!e||new Set(["no_user","null","none","nil","(null)","NaN","\\x00","","unidentified","undefined","unknown"]).has(e)||e.includes("/"))throw new p(u.InvalidAppUserIdError,'Provided user id: "'+(null!==e&&void 0!==e?e:"[Not provided]")+'" is not valid. See https://www.revenuecat.com/docs/customers/user-ids#tips-for-setting-app-user-ids for more information.')}var se=(e=>(e.Current="current",e))(se||{});function ae(e){return null!=e}var ce=(e=>(e.Year="year",e.Month="month",e.Week="week",e.Day="day",e))(ce||{});const ue=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=(e=>e/1e6)(e),s=(0,n.Z)((0,n.Z)({style:"currency",currency:t,currencyDisplay:"symbol"},i),{},{minimumFractionDigits:i.maximumFractionDigits});return new Intl.NumberFormat(r,s).format(o).replace("US$","$")};const le=e=>({amount:e.amount_micros/1e4,amountMicros:e.amount_micros,currency:e.currency,formattedPrice:ue(e.amount_micros,e.currency)}),de=e=>{const t=e.period_duration,r=e.price?le(e.price):null,n=t?function(e){const t=e.match(/^PT?([0-9]+)([MDYW])$/);if(!t||t.length<3)return a.errorLog("Invalid ISO 8601 duration format: ".concat(e)),null;const r=parseInt(t[1]);switch(t[2]){case"Y":return{number:r,unit:"year"};case"M":return{number:r,unit:"month"};case"W":return{number:r,unit:"week"};case"D":return{number:r,unit:"day"};default:return a.errorLog("Invalid ISO 8601 unit duration format: ".concat(e)),null}}(t):null;let i=null,o=null,s=null;if(null!==r&&null!==n){const e=function(e){const{number:t,unit:r}=e,n=7,i=30,o=365;let s;switch(r){case ce.Day:s=t;break;case ce.Week:s=t*n;break;case ce.Month:s=t*i;break;case ce.Year:s=t*o;break;default:s=0,a.errorLog("Unknown period unit: ".concat(r))}const c=s>0?n/s:0,u=s>0?i/s:0,l=s>0?o/s:0;return{toWeek:c,toMonth:u,toYear:l}}(n),t=1e4,c=Math.round(r.amountMicros*e.toWeek);i={amount:c/t,amountMicros:c,currency:r.currency,formattedPrice:ue(c,r.currency)};const u=Math.round(r.amountMicros*e.toMonth);o={amount:u/t,amountMicros:u,currency:r.currency,formattedPrice:ue(u,r.currency)};const l=Math.round(r.amountMicros*e.toYear);s={amount:l/t,amountMicros:l,currency:r.currency,formattedPrice:ue(l,r.currency)}}return{periodDuration:t,period:n,cycleCount:e.cycle_count,price:r,pricePerWeek:i,pricePerMonth:o,pricePerYear:s}};const pe=(e,t,r)=>{const n={};if(Object.entries(e.purchase_options).forEach((e=>{let[t,r]=e;const i=(e=>null==e.base_price?(a.debugLog("Missing base price for non-subscription option. Ignoring."),null):{id:e.id,priceId:e.price_id,basePrice:le(e.base_price)})(r);null!=i&&(n[t]=i)})),0===Object.keys(n).length)return a.debugLog("Product ".concat(e.identifier," has no purchase options. Ignoring.")),null;const i=e.default_purchase_option_id,o=i&&i in e.purchase_options?n[i]:null;return null==o?(a.debugLog("Product ".concat(e.identifier," has no default purchase option. Ignoring.")),null):{identifier:e.identifier,displayName:e.title,title:e.title,description:e.description,productType:r,currentPrice:o.basePrice,normalPeriodDuration:null,presentedOfferingIdentifier:t.offeringIdentifier,presentedOfferingContext:t,defaultPurchaseOption:o,defaultSubscriptionOption:null,subscriptionOptions:{},defaultNonSubscriptionOption:o,price:o.basePrice,period:null,freeTrialPhase:null,introPricePhase:null}},he=(e,t,r)=>{const n={};if(Object.entries(e.purchase_options).forEach((e=>{let[t,r]=e;const i=(e=>null==e.base?(a.debugLog("Missing base phase for subscription option. Ignoring."),null):{id:e.id,priceId:e.price_id,base:de(e.base),trial:e.trial?de(e.trial):null,introPrice:e.intro_price?de(e.intro_price):null})(r);null!=i&&(n[t]=i)})),0===Object.keys(n).length)return a.debugLog("Product ".concat(e.identifier," has no subscription options. Ignoring.")),null;const i=e.default_purchase_option_id,o=i&&i in n?n[i]:null;if(null==o)return a.debugLog("Product ".concat(e.identifier," has no default subscription option. Ignoring.")),null;const s=o.base.price;return null==s?(a.debugLog("Product ".concat(e.identifier," default option has no base price. Ignoring.")),null):{identifier:e.identifier,displayName:e.title,title:e.title,description:e.description,productType:r,currentPrice:s,normalPeriodDuration:o.base.periodDuration,presentedOfferingIdentifier:t.offeringIdentifier,presentedOfferingContext:t,defaultPurchaseOption:o,defaultSubscriptionOption:o,subscriptionOptions:n,defaultNonSubscriptionOption:null,price:s,period:o.base.period,freeTrialPhase:o.trial,introPricePhase:o.introPrice}},fe=(e,t,r)=>{const n=r[t.platform_product_identifier];if(void 0===n)return null;const i=((e,t)=>{const r=e.product_type;return"subscription"===r?he(e,t,r):pe(e,t,r)})(n,e);return null===i?null:{identifier:t.identifier,rcBillingProduct:i,webBillingProduct:i,packageType:ge(t.identifier)}};function ge(e){switch(e){case"$rc_lifetime":return"$rc_lifetime";case"$rc_annual":return"$rc_annual";case"$rc_six_month":return"$rc_six_month";case"$rc_three_month":return"$rc_three_month";case"$rc_two_month":return"$rc_two_month";case"$rc_monthly":return"$rc_monthly";case"$rc_weekly":return"$rc_weekly";default:return e.startsWith("$rc_")?"unknown":"custom"}}const Ee=(e,t)=>{const r=(0,n.Z)((0,n.Z)({},e.webBillingProduct),{},{presentedOfferingContext:(0,n.Z)((0,n.Z)({},e.webBillingProduct.presentedOfferingContext),{},{placementIdentifier:t})});return(0,n.Z)((0,n.Z)({},e),{},{webBillingProduct:r,rcBillingProduct:r})},me=(e,t)=>null==e?null:Ee(e,t);function _e(e,t){var r;const n={};t.product_details.forEach((e=>{n[e.identifier]=e}));const i={};e.offerings.forEach((t=>{const r=((e,t,r,n)=>{var i,o,s,a,c,u,l;const d={offeringIdentifier:t.identifier,targetingContext:e&&n?{ruleId:n.rule_id,revision:n.revision}:null,placementIdentifier:null},p=t.packages.map((e=>fe(d,e,r))).filter(ae),h={};for(const f of p)null!=f&&(h[f.identifier]=f);return 0==p.length?null:{identifier:t.identifier,serverDescription:t.description,metadata:t.metadata,packagesById:h,availablePackages:p,lifetime:null!==(i=h.$rc_lifetime)&&void 0!==i?i:null,annual:null!==(o=h.$rc_annual)&&void 0!==o?o:null,sixMonth:null!==(s=h.$rc_six_month)&&void 0!==s?s:null,threeMonth:null!==(a=h.$rc_three_month)&&void 0!==a?a:null,twoMonth:null!==(c=h.$rc_two_month)&&void 0!==c?c:null,monthly:null!==(u=h.$rc_monthly)&&void 0!==u?u:null,weekly:null!==(l=h.$rc_weekly)&&void 0!==l?l:null,paywall_components:t.paywall_components?t.paywall_components:null}})(t.identifier===e.current_offering_id,t,n,e.targeting);null!=r&&(i[t.identifier]=r)}));const o=e.current_offering_id&&null!==(r=i[e.current_offering_id])&&void 0!==r?r:null;return 0==Object.keys(i).length&&a.debugLog("Empty offerings. Please make sure you've configured offerings correctly in the RevenueCat dashboard and that the products are properly configured."),{all:i,current:o}}const Ie=[];for(let Ye=0;Ye<256;++Ye)Ie.push((Ye+256).toString(16).slice(1));let ye;const ve=new Uint8Array(16);const be={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Pe(e,t,r){var n,i,o;if(be.randomUUID&&!e)return be.randomUUID();const s=null!==(n=null!==(i=(e=e||{}).random)&&void 0!==i?i:null==(o=e.rng)?void 0:o.call(e))&&void 0!==n?n:function(){if(!ye){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ye=crypto.getRandomValues.bind(crypto)}return ye(ve)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=15&s[6]|64,s[8]=63&s[8]|128,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Ie[e[t+0]]+Ie[e[t+1]]+Ie[e[t+2]]+Ie[e[t+3]]+"-"+Ie[e[t+4]]+Ie[e[t+5]]+"-"+Ie[e[t+6]]+Ie[e[t+7]]+"-"+Ie[e[t+8]]+Ie[e[t+9]]+"-"+Ie[e[t+10]]+Ie[e[t+11]]+Ie[e[t+12]]+Ie[e[t+13]]+Ie[e[t+14]]+Ie[e[t+15]]).toLowerCase()}(s)}var Te=/(%?)(%([sdijo]))/g;function Se(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(0===r.length)return e;let i=0,o=e.replace(Te,((e,t,n,o)=>{const s=function(e,t){switch(t){case"s":return e;case"d":case"i":return Number(e);case"j":return JSON.stringify(e);case"o":{if("string"==typeof e)return e;const t=JSON.stringify(e);return"{}"===t||"[]"===t||/^\[object .+?\]$/.test(t)?e:t}}}(r[i],o);return t?e:(i++,s)}));return i<r.length&&(o+=" ".concat(r.slice(i).join(" "))),o=o.replace(/%{2,2}/g,"%"),o}var we=class extends Error{constructor(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];super(e),this.message=e,this.name="Invariant Violation",this.message=Se(e,...r),function(e){if(!e.stack)return;const t=e.stack.split("\n");t.splice(1,2),e.stack=t.join("\n")}(this)}},ke=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(!e)throw new we(t,...n)};ke.as=function(e,t,r){if(!t){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];const t=0===i.length?r:Se(r,...i);let a;try{a=Reflect.construct(e,[t])}catch(s){a=e(t)}throw a}};const Ae="[MSW]";function Ce(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=Se(e,...r);return"".concat(Ae," ").concat(i)}const Oe={formatMessage:Ce,warn:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];console.warn(Ce(e,...r))},error:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];console.error(Ce(e,...r))}};var Re=(e=>(e.HEAD="HEAD",e.GET="GET",e.POST="POST",e.PUT="PUT",e.PATCH="PATCH",e.OPTIONS="OPTIONS",e.DELETE="DELETE",e))(Re||{});ke(typeof URL<"u",Oe.formatMessage('Global "URL" class is not defined. This likely means that you\'re running MSW in an environment that doesn\'t support all Node.js standard API (e.g. React Native). If that\'s the case, please use an appropriate polyfill for the "URL" class, like "react-native-url-polyfill".'));class Ue{constructor(e,t,r,n){o(this,"initialDelay"),o(this,"maxDelay"),o(this,"jitterPercent"),o(this,"callback"),o(this,"currentDelay"),o(this,"timeoutId"),o(this,"executingCallback",!1),this.initialDelay=e,this.currentDelay=e,this.maxDelay=t,this.jitterPercent=r,this.callback=n}tryFlush(){this.backingOff()?a.debugLog("Backing off, not flushing"):(this.clearTimeout(),this.executeCallbackWithRetries())}stop(){this.clearTimeout()}schedule(e){if(void 0!==this.timeoutId)return;const t=this.addJitter(e||this.currentDelay);this.timeoutId=setTimeout((()=>{this.timeoutId=void 0,this.executeCallbackWithRetries()}),t)}backoff(){const e=this.currentDelay,t=Math.min(2*this.currentDelay,this.maxDelay);a.debugLog("Backing next off to ".concat(e,"ms delay")),this.clearTimeout(),this.currentDelay=t,this.schedule(e)}reset(){this.currentDelay!==this.initialDelay&&(this.clearTimeout(),this.currentDelay=this.initialDelay)}async executeCallbackWithRetries(){if(this.executingCallback)return a.debugLog("Callback already running, rescheduling"),void this.schedule();this.executingCallback=!0;try{await this.callback(),this.reset()}catch(e){this.backoff()}finally{this.executingCallback=!1}}backingOff(){return this.currentDelay>this.initialDelay}clearTimeout(){clearTimeout(this.timeoutId),this.timeoutId=void 0}addJitter(e){const t=e*this.jitterPercent,r=e-t,n=e+t;return Math.floor(Math.random()*(n-r+1)+r)}}function Ne(e){const t={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const n=r.replace(/([A-Z])/g,"_$1").toLowerCase(),i=e[r];i&&"object"==typeof i&&!Array.isArray(i)?t[n]=Ne(i):t[n]=i}return t}class De{constructor(e){o(this,"EVENT_TYPE","web_billing"),o(this,"id"),o(this,"timestampMs"),o(this,"data"),this.id=Pe(),this.timestampMs=Date.now(),this.data=e}toJSON(){return Ne({id:this.id,timestampMs:this.timestampMs,type:this.EVENT_TYPE,eventName:this.data.eventName,appUserId:this.data.appUserId,context:(0,n.Z)({},this.data.context),properties:(0,n.Z)((0,n.Z)({},this.data.properties),{},{traceId:this.data.traceId})})}}function xe(e,t){var r,n,i,o,s;const a=new URLSearchParams(window.location.search);return{libraryName:"purchases-js",libraryVersion:b,locale:navigator.language,userAgent:navigator.userAgent,timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,screenWidth:screen.width,screenHeight:screen.height,utmSource:null!==(r=a.get("utm_source"))&&void 0!==r?r:null,utmMedium:null!==(n=a.get("utm_medium"))&&void 0!==n?n:null,utmCampaign:null!==(i=a.get("utm_campaign"))&&void 0!==i?i:null,utmContent:null!==(o=a.get("utm_content"))&&void 0!==o?o:null,utmTerm:null!==(s=a.get("utm_term"))&&void 0!==s?s:null,pageReferrer:document.referrer,pageUrl:"".concat(window.location.origin).concat(window.location.pathname),pageTitle:document.title,source:e,rcSource:t}}class Be{constructor(e){o(this,"apiKey"),o(this,"eventsQueue",[]),o(this,"eventsUrl"),o(this,"flushManager"),o(this,"traceId",Pe()),o(this,"appUserId"),o(this,"isSilent"),o(this,"rcSource"),this.apiKey=e.apiKey,this.eventsUrl="".concat("https://e.revenue.cat","/v1/events"),this.appUserId=e.appUserId,this.isSilent=e.silent||!1,this.rcSource=e.rcSource,this.flushManager=new Ue(2e3,3e5,.1,this.flushEvents.bind(this))}async updateUser(e){this.appUserId=e}getTraceId(){return this.traceId}trackSDKEvent(e){this.trackEvent((0,n.Z)((0,n.Z)({},e),{},{source:"sdk"}))}trackExternalEvent(e){this.trackEvent((0,n.Z)({},e))}trackEvent(e){if(this.isSilent)a.verboseLog("Skipping event tracking, the EventsTracker is silent");else try{const t=new De({eventName:e.eventName,traceId:this.traceId,appUserId:this.appUserId,context:xe(e.source,this.rcSource),properties:e.properties||{}});this.eventsQueue.push(t),this.flushManager.tryFlush()}catch(t){a.errorLog("Error while tracking event ".concat(e.eventName))}}dispose(){this.flushManager.stop()}flushEvents(){if(0===this.eventsQueue.length)return Promise.resolve();const e=[...this.eventsQueue];return fetch(this.eventsUrl,{method:Re.POST,headers:Y(this.apiKey),body:JSON.stringify({events:e})}).then((t=>{if(200!==t.status&&201!==t.status)throw a.debugLog("Events failed to flush due to server error"),new Error("Events failed to flush due to server error");this.eventsQueue.splice(0,e.length)})).catch((e=>{throw a.debugLog("Error while flushing events"),e}))}}var Le=(e=>(e.SDKInitialized="sdk_initialized",e.CheckoutSessionStart="checkout_session_start",e.CheckoutSessionEnd="checkout_session_end",e.CheckoutFlowError="checkout_flow_error",e.CheckoutPaymentTaxCalculation="checkout_payment_tax_calculation",e.CheckoutPaymentFormImpression="checkout_payment_form_impression",e.CheckoutPaymentFormError="checkout_payment_form_error",e.CheckoutPaymentFormDismiss="checkout_payment_form_dismiss",e.CheckoutPaymentFormSubmit="checkout_payment_form_submit",e.CheckoutPaymentFormGatewayError="checkout_payment_form_gateway_error",e.CheckoutPurchaseSuccessfulImpression="checkout_purchase_successful_impression",e.CheckoutPurchaseSuccessfulDismiss="checkout_purchase_successful_dismiss",e))(Le||{});const Me={autoCollectUTMAsMetadata:!0,collectAnalyticsEvents:!0};const Fe="$RCAnonymousID:",Ke=class e{constructor(e,t){var r;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:re,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Me;o(this,"_API_KEY"),o(this,"_appUserId"),o(this,"_brandingInfo",null),o(this,"_loadingResourcesPromise",null),o(this,"_flags"),o(this,"backend"),o(this,"eventsTracker"),this._API_KEY=e,this._appUserId=t,this._flags=(0,n.Z)((0,n.Z)({},Me),s),A(e)?a.debugLog("Initializing Purchases SDK with Web billing sandbox API Key"):C(e)&&a.debugLog("Initializing Purchases SDK with RC Test store API Key."),this.eventsTracker=new Be({apiKey:this._API_KEY,appUserId:this._appUserId,silent:!this._flags.collectAnalyticsEvents,rcSource:null!==(r=this._flags.rcSource)&&void 0!==r?r:null}),this.backend=new ne(this._API_KEY,i),this.eventsTracker.trackSDKEvent({eventName:Le.SDKInitialized})}static setLogLevel(e){a.setLogLevel(e)}static setPlatformInfo(t){e._platformInfo=t}static getPlatformInfo(){return e._platformInfo}static getSharedInstance(){if(e.isConfigured())return e.instance;throw new h}static isConfigured(){return void 0!==e.instance}static configure(t,r,n,i){let o;if(void 0!==e.instance&&a.warnLog("Purchases is already initialized. You normally should only configure Purchases once. Creating and returning new instance."),"object"==typeof t&&null!==t)o=t;else{if("string"!=typeof t)throw new p(u.ConfigurationError,"API key must be provided as a string");if("string"!=typeof r)throw new p(u.ConfigurationError,"App user ID must be provided as a string");o={apiKey:t,appUserId:r,httpConfig:n,flags:i}}return e.configureInternal(o),e.getSharedInstance()}static configureInternal(t){const{apiKey:r,appUserId:n,httpConfig:i,flags:o}=t,s=null!==i&&void 0!==i?i:re,a=null!==o&&void 0!==o?o:Me;e.validateConfig(t),e.instance=new e(r,n,s,a)}static validateConfig(e){var t,r;ie(e.apiKey,e.flags),oe(e.appUserId),function(e){if(null!=e&&e.endsWith("/"))throw new p(u.ConfigurationError,"Invalid proxy URL. The proxy URL should not end with a trailing slash.")}(null==(t=e.httpConfig)?void 0:t.proxyURL),function(e){if(e)for(const t in e)if($.has(t))throw new p(u.ConfigurationError,"Invalid additional headers. Some headers are reserved for internal use.")}(null==(r=e.httpConfig)?void 0:r.additionalHeaders)}async preload(){if(!this.hasLoadedResources())return null!==this._loadingResourcesPromise?(a.verboseLog("Purchases resources are loading. Waiting."),void await this._loadingResourcesPromise):(this._loadingResourcesPromise=this.fetchAndCacheBrandingInfo().catch((e=>{let t="".concat(e);e instanceof p&&(t="".concat(e.message,". ").concat(e.underlyingErrorMessage?"Underlying error: ".concat(e.underlyingErrorMessage):"")),a.errorLog("Error fetching branding info: ".concat(t))})).finally((()=>{this._loadingResourcesPromise=null})),this._loadingResourcesPromise);a.verboseLog("Purchases resources are loaded. Skipping.")}async fetchAndCacheBrandingInfo(){C(this._API_KEY)?a.warnLog("Branding info is not available for RC Test Store API keys."):this._brandingInfo=await this.backend.getBrandingInfo()}hasLoadedResources(){return null!==this._brandingInfo}async getOfferings(e){!function(e){if(e&&!e.match(/^[A-Z]{3}$/)){const t="Currency code ".concat(e," is not valid. Please provide a valid ISO 4217 currency code.");throw a.errorLog(t),new p(u.ConfigurationError,t)}}(null==e?void 0:e.currency);const t=this._appUserId,r=await this.backend.getOfferings(t),n=(null==e?void 0:e.offeringIdentifier)===se.Current?r.current_offering_id:null==e?void 0:e.offeringIdentifier;return n&&(r.offerings=r.offerings.filter((e=>e.identifier===n))),await this.getAllOfferings(r,t,e)}async getCurrentOfferingForPlacement(e,t){var r;const i=this._appUserId,o=await this.backend.getOfferings(i),s=await this.getAllOfferings(o,i,t),a=null!==(r=o.placements)&&void 0!==r?r:null;return null==a?null:((e,t,r)=>{var i,o;const s=null!==(i=e.offering_ids_by_placement)&&void 0!==i?i:null;if(null==s)return null;const a=null!==(o=e.fallback_offering_id)&&void 0!==o?o:null;let c;if(r in s){var u;const e=null!==(u=s[r])&&void 0!==u?u:null;if(null==e)return null;c=t[e],null==c&&(c=t[a])}else c=t[a];if(null==c)return null;const l=Object.fromEntries(Object.entries(c.packagesById).map((e=>{let[t,n]=e;return[t,Ee(n,r)]})));return(0,n.Z)((0,n.Z)({},c),{},{packagesById:l,availablePackages:Object.values(l),weekly:me(c.weekly,r),monthly:me(c.monthly,r),twoMonth:me(c.twoMonth,r),threeMonth:me(c.threeMonth,r),sixMonth:me(c.sixMonth,r),annual:me(c.annual,r),lifetime:me(c.lifetime,r)})})(a,s.all,e)}async getAllOfferings(e,t,r){const n=e.offerings.flatMap((e=>e.packages)).map((e=>e.platform_product_identifier)),i=await this.backend.getProducts(t,n,null==r?void 0:r.currency);return this.logMissingProductIds(n,i.product_details),_e(e,i)}async isEntitledTo(e){return e in(await this.getCustomerInfo()).entitlements.active}async getCustomerInfo(){return await this._getCustomerInfoForUserId(this._appUserId)}getAppUserId(){return this._appUserId}async setAttributes(e){return await this.getCustomerInfo(),await this.backend.setAttributes(this._appUserId,e)}async changeUser(e){return oe(e),this._appUserId=e,this.eventsTracker.updateUser(e),await this.getCustomerInfo()}logMissingProductIds(e,t){const r={};t.forEach((e=>r[e.identifier]=e));const n=[];e.forEach((e=>{void 0===r[e]&&n.push(e)})),n.length>0&&a.debugLog("Could not find product data for product ids:\n        ".concat(n.join(),".\n        Please check that your product configuration is correct."))}isSandbox(){return A(this._API_KEY)||C(this._API_KEY)}isAnonymous(){return this._appUserId.startsWith(Fe)}close(){e.instance===this?(this.eventsTracker&&this.eventsTracker.dispose(),e.instance=void 0):a.warnLog("Trying to close a Purchases instance that is not the current instance. Ignoring.")}async _getCustomerInfoForUserId(e){return _(await this.backend.getCustomerInfo(e))}static generateRevenueCatAnonymousAppUserId(){return"".concat(Fe).concat(function(){if(crypto&&crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(16);if(crypto&&crypto.getRandomValues)crypto.getRandomValues(e);else for(let r=0;r<16;r++)e[r]=Math.floor(256*Math.random());e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Array.from(e).map((e=>e.toString(16).padStart(2,"0")));return[t.slice(0,4).join(""),t.slice(4,6).join(""),t.slice(6,8).join(""),t.slice(8,10).join(""),t.slice(10,16).join("")].join("-")}().replace(/-/g,""))}_trackEvent(e){this.eventsTracker.trackExternalEvent(e)}};o(Ke,"_platformInfo"),o(Ke,"instance");let $e=Ke}}]);